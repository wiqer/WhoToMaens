# 微调代码评审检查表

## 基础项确认：
- [ ] 数据集版本与配置文件匹配
- [ ] 梯度流可视化功能已启用
- [ ] 使用contextlib.nullcontext管理训练模式
- [ ] 所有外部输入参数均添加类型注解
- [ ] 关键路径包含详细日志记录

## 高危区域复核：
### 1. 权重初始化：
- [ ] 查验init_weights方法实现
- [ ] 确认是否遵循论文推荐方案
- [ ] 检查权重缩放因子设置

### 2. 分布式训练：
```python
if __name__ == "__main__":
    mp.spawn(main, args=(args,), nprocs=torch.cuda.device_count())
```
- [ ] 验证分布式环境变量配置
- [ ] 检查模型参数是否正确同步
- [ ] 确认数据加载器使用DistributedSampler

### 3. 显存管理：
- [ ] 已启用4-bit/8-bit量化
- [ ] 梯度检查点功能正常工作
- [ ] 非必要 tensors 使用 torch.no_grad()

### 4. 异常处理：
- [ ] 模型加载包含try-except块
- [ ] 数据预处理添加字段校验
- [ ] 文件操作前检查路径权限

## 优化项建议：
- [ ] 实现学习率余弦退火调度
- [ ] 添加梯度范数监控
- [ ] 启用混合精度训练
- [ ] 实现模型保存失败重试机制