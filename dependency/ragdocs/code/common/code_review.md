# BugAgaric Common æ¨¡å—ä»£ç å®¡æŸ¥æŠ¥å‘Š

## 1. ä»£ç å®¡æŸ¥æ–¹æ³•è®º

### 1.1 å®¡æŸ¥ç»´åº¦
- ä»£ç è´¨é‡
- æ€§èƒ½ä¼˜åŒ–
- å®‰å…¨æ€§
- å¯ç»´æŠ¤æ€§
- å¯æµ‹è¯•æ€§
- é”™è¯¯å¤„ç†
- æ–‡æ¡£å®Œæ•´æ€§

### 1.2 é£é™©ç­‰çº§å®šä¹‰
- ğŸ”´ çº¢è‰²ï¼šä¸¥é‡é—®é¢˜ï¼Œéœ€è¦ç«‹å³ä¿®å¤
- ğŸŸ¡ é»„è‰²ï¼šæ½œåœ¨é—®é¢˜ï¼Œå»ºè®®åœ¨ä¸‹ä¸€ä¸ªè¿­ä»£ä¸­ä¿®å¤
- ğŸ”µ è“è‰²ï¼šä¼˜åŒ–å»ºè®®ï¼Œå¯ä»¥åœ¨åç»­ç‰ˆæœ¬ä¸­è€ƒè™‘

## 2. é—®é¢˜æ±‡æ€»

### 2.1 utils.py

#### ğŸ”´ ä¸¥é‡é—®é¢˜
1. é”™è¯¯å¤„ç†ä¸å®Œå–„
   - `get_embedding_types()` å‡½æ•°æ²¡æœ‰å¼‚å¸¸å¤„ç†æœºåˆ¶
   - ç½‘ç»œè¯·æ±‚å¯èƒ½å¤±è´¥ï¼Œéœ€è¦æ·»åŠ è¶…æ—¶å’Œé‡è¯•æœºåˆ¶

2. å®‰å…¨æ€§é—®é¢˜
   - `get_image_fold()` å‡½æ•°ä¸­çš„ HTML æ³¨å…¥é£é™©
   - å›¾ç‰‡ URL æœªè¿›è¡Œå®‰å…¨éªŒè¯

#### ğŸŸ¡ æ½œåœ¨é—®é¢˜
1. æ€§èƒ½é—®é¢˜
   - `chunk_by_sentence()` å‡½æ•°åœ¨å¤„ç†å¤§æ–‡æœ¬æ—¶å¯èƒ½å­˜åœ¨æ€§èƒ½é—®é¢˜
   - æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼å¯ä»¥ä¼˜åŒ–

2. ä»£ç ç»“æ„
   - å…¨å±€å˜é‡ `GENERATE_PROMPTS` åº”è¯¥ç§»åˆ°é…ç½®æ–‡ä»¶
   - å‡½æ•°ä¹‹é—´çš„ä¾èµ–å…³ç³»ä¸æ¸…æ™°

#### ğŸ”µ ä¼˜åŒ–å»ºè®®
1. ä»£ç è´¨é‡
   - æ·»åŠ ç±»å‹æ³¨è§£
   - å¢åŠ å•å…ƒæµ‹è¯•
   - ä¼˜åŒ–æ—¥å¿—è®°å½•

### 2.2 batch_gather.py

#### ğŸ”´ ä¸¥é‡é—®é¢˜
1. å¹¶å‘å®‰å…¨é—®é¢˜
   - `SingleTask` ç±»çš„æ¡ä»¶å˜é‡ä½¿ç”¨å¯èƒ½å­˜åœ¨é—®é¢˜
   - çº¿ç¨‹åŒæ­¥æœºåˆ¶éœ€è¦åŠ å¼º

2. èµ„æºç®¡ç†
   - æ²¡æœ‰ä¼˜é›…çš„å…³é—­æœºåˆ¶
   - çº¿ç¨‹æ± èµ„æºå¯èƒ½æ³„éœ²

#### ğŸŸ¡ æ½œåœ¨é—®é¢˜
1. é”™è¯¯å¤„ç†
   - å¼‚å¸¸ä¼ æ’­æœºåˆ¶ä¸å®Œå–„
   - ç¼ºå°‘é”™è¯¯æ¢å¤æœºåˆ¶

2. æ€§èƒ½é—®é¢˜
   - æ‰¹å¤„ç†å¤§å°å›ºå®šï¼Œç¼ºä¹åŠ¨æ€è°ƒæ•´
   - é˜Ÿåˆ—å®¹é‡é™åˆ¶å¯èƒ½å½±å“æ€§èƒ½

#### ğŸ”µ ä¼˜åŒ–å»ºè®®
1. ä»£ç ç»“æ„
   - æ·»åŠ ç›‘æ§æŒ‡æ ‡
   - å®ç°ä¼˜é›…é™çº§
   - å¢åŠ æ€§èƒ½æŒ‡æ ‡æ”¶é›†

### 2.3 prompts.py

#### ğŸ”´ ä¸¥é‡é—®é¢˜
1. å®‰å…¨æ€§
   - ç³»ç»Ÿæç¤ºè¯ä¸­åŒ…å«æ•æ„Ÿä¿¡æ¯
   - ç¼ºå°‘è¾“å…¥éªŒè¯

#### ğŸŸ¡ æ½œåœ¨é—®é¢˜
1. å¯ç»´æŠ¤æ€§
   - æç¤ºè¯æ¨¡æ¿è¿‡äºå¤æ‚
   - ç¼ºå°‘ç‰ˆæœ¬æ§åˆ¶

#### ğŸ”µ ä¼˜åŒ–å»ºè®®
1. ä»£ç è´¨é‡
   - å°†æç¤ºè¯æ¨¡æ¿åˆ†ç¦»åˆ°é…ç½®æ–‡ä»¶
   - æ·»åŠ æç¤ºè¯éªŒè¯æœºåˆ¶

## 3. æ”¹è¿›å»ºè®®

### 3.1 ç«‹å³æ”¹è¿›é¡¹
1. æ·»åŠ å¼‚å¸¸å¤„ç†æœºåˆ¶
2. å®ç°å®‰å…¨éªŒè¯
3. ä¼˜åŒ–çº¿ç¨‹åŒæ­¥
4. æ·»åŠ èµ„æºç®¡ç†

### 3.2 ä¸­æœŸæ”¹è¿›é¡¹
1. é‡æ„ä»£ç ç»“æ„
2. æ·»åŠ å•å…ƒæµ‹è¯•
3. å®ç°æ€§èƒ½ç›‘æ§
4. ä¼˜åŒ–é…ç½®ç®¡ç†

### 3.3 é•¿æœŸæ”¹è¿›é¡¹
1. å®ç°è‡ªåŠ¨åŒ–æµ‹è¯•
2. æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•
3. ä¼˜åŒ–æ–‡æ¡£ç³»ç»Ÿ
4. å®ç°ç›‘æ§å‘Šè­¦

## 4. å¯å¤ç”¨æ£€æµ‹è„šæœ¬

```python
import ast
import re
from typing import List, Dict

class CodeAnalyzer:
    def __init__(self):
        self.issues = {
            'red': [],
            'yellow': [],
            'blue': []
        }
    
    def analyze_file(self, file_path: str) -> Dict[str, List[str]]:
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()
            
        tree = ast.parse(content)
        
        # æ£€æŸ¥å¼‚å¸¸å¤„ç†
        self._check_exception_handling(tree)
        
        # æ£€æŸ¥å®‰å…¨æ€§é—®é¢˜
        self._check_security_issues(tree)
        
        # æ£€æŸ¥æ€§èƒ½é—®é¢˜
        self._check_performance_issues(tree)
        
        return self.issues
    
    def _check_exception_handling(self, tree: ast.AST):
        # å®ç°å¼‚å¸¸å¤„ç†æ£€æŸ¥é€»è¾‘
        pass
    
    def _check_security_issues(self, tree: ast.AST):
        # å®ç°å®‰å…¨æ€§æ£€æŸ¥é€»è¾‘
        pass
    
    def _check_performance_issues(self, tree: ast.AST):
        # å®ç°æ€§èƒ½é—®é¢˜æ£€æŸ¥é€»è¾‘
        pass

def main():
    analyzer = CodeAnalyzer()
    # ä½¿ç”¨ç¤ºä¾‹
    issues = analyzer.analyze_file('path/to/file.py')
    print(issues)

if __name__ == '__main__':
    main()
```

## 5. æ€»ç»“

æœ¬æ¬¡ä»£ç å®¡æŸ¥å‘ç°äº†å¤šä¸ªéœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œä¸»è¦é›†ä¸­åœ¨é”™è¯¯å¤„ç†ã€å®‰å…¨æ€§ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§æ–¹é¢ã€‚å»ºè®®æŒ‰ç…§ä¼˜å…ˆçº§é€æ­¥å®æ–½æ”¹è¿›å»ºè®®ï¼Œå¹¶å»ºç«‹é•¿æœŸçš„ä»£ç è´¨é‡ç›‘æ§æœºåˆ¶ã€‚

### 5.1 å…³é”®æŒ‡æ ‡
- ä»£ç è¦†ç›–ç‡ç›®æ ‡ï¼š80%
- æ€§èƒ½åŸºå‡†ï¼šå“åº”æ—¶é—´ < 100ms
- é”™è¯¯ç‡ï¼š< 0.1%

### 5.2 åç»­è¡ŒåŠ¨
1. å»ºç«‹ä»£ç å®¡æŸ¥æµç¨‹
2. å®æ–½è‡ªåŠ¨åŒ–æµ‹è¯•
3. å®šæœŸè¿›è¡Œæ€§èƒ½è¯„ä¼°
4. æŒç»­ä¼˜åŒ–ä»£ç è´¨é‡ 